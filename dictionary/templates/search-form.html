<!-- #live-search -->
<div id="live-search" ng-controller="SearchRequestCtrl">
	<form id="searchform" class="clearfix" ng-submit="search()" >
		{% csrf_token %}
        <input type="text" ng-focus='onFocus()' ng-blur='onBlur()' ng-model="keyword" name="ipt-text">
		<!--<input type="submit" value="Enviar">-->
	</form>
	<div class="search-result">
		<ul>
	    	<li class="search-result-item" ng-repeat="word in words">
				<a href="{% verbatim %}{{ word.relative_url }}{% endverbatim %}"><span>{% verbatim %}{{ word.word }}{% endverbatim %}</span></a>
	    	</li>
	  	</ul>
	</div>
</div>

<!-- onfocus="if (this.value == 'Digite alguma palavra') {this.value = '';}" onblur="if (this.value == '')  {this.value = 'Digite alguma palavra';}" value="Digite alguma palavra"  -->

<script>

nirvarisControllers.controller('SearchRequestCtrl', ['$scope', '$http', function ($scope, $http, $sce) {
	$scope.keyword = '';
	$scope.results = [];
	
	$scope.onFocus = function(){
		console.log('focus');
	}
	
	$scope.onBlur = function(){
		console.log('blur');
	}

	$scope.search = function() {
		/*$http.get('/dictionary/search', { params: $scope.keyword },
	        function(response) { $scope.results = response; },
	        function(failure) { console.log("failed :(", failure); }
		);*/
		
		
		$http.post('/dictionary/search', $.param({ 
			search_input: $scope.keyword,
			csrfmiddlewaretoken: angular.element(document.getElementsByName('csrfmiddlewaretoken')[0]).val() 
		}), {headers: {'Content-Type': 'application/x-www-form-urlencoded'}}).
		then(function(response) {
			// this callback will be called asynchronously
			// when the response is available
			$scope.words = response.data; 
		}, function(response) {
			// called asynchronously if an error occurs
			// or server returns response with an error status.
			console.log("failed :(", response); 
		});
	};

}]);

</script>